Sobre PDFBeads
--------------

**PDFBeads** es un programa generador de PDFs desarrollado en [Ruby](http://es.wikipedia.org/wiki/Ruby) por Alexey Kryukov. La aplicación fue diseñada especialmente para trabajar con las imágenes procesadas con [Scantailor](http://wiki.diybookscanner.org/scantailor). 

##### Características:

 -  Genera un documento PDF a partir de archivos TIFF numerados en orden.
 -  No tiene interfaz gráfica, el programa se ejecuta desde la línea de comandos.
 -  Reduce el tamaño del PDF comprimiendo los datos con el algoritmo [JBIG2](http://en.wikipedia.org/wiki/JBIG2).
 -  Reconoce el formato estándar [hOCR](http://en.wikipedia.org/wiki/HOCR) y puede incorporar al PDF la información obtenida por reconocimiento óptico de caracteres ([OCR](http://es.wikipedia.org/wiki/Reconocimiento_%C3%B3ptico_de_caracteres)), habilitando búsquedas dentro del documento.

##### Sitios

 -  [Sitio de PDFBeads en Rubyforge](http://rubyforge.org/projects/pdfbeads/)
 -  [Hilo sodre PDFBeads en el foro de DIYBookScanner](http://diybookscanner.org/forum/viewtopic.php?f=3&t=683).
 -  @@[Referencia parametros PDFBeads en DIYBookScanner](http://www.diybookscanner.org/forum/viewtopic.php?f=20&t=2971&start=20)@@
 -  [Manual oficial en ruso](http://rubyforge.org/docman/view.php/9752/10692/pdfbeads.html)
 -  [Repositorio en Github](https://github.com/ifad/pdfbeads)


Instalar PDFBeads en Debian Wheezy
----------------------------------

### Pre-requisitos para la compilación

Asegurarse que el repositorio de código fuente esté habilitado en la lista de fuentes de Debian en `/etc/apt/sources.list`. Si no, editar el archivo (como *root*) y agregar o descomentar esta línea:

    deb-src http://ftp.us.debian.org/debian wheezy main

Actualizar la lista de paquetes de Debian:

    apt-get update


---------

Nota (2016): `pdfbeads 1.1.1` no es compatible con versiones de `ruby` superiores a `1.9.3`. Debian Wheezy tiene disponibles las versiones `1.8.7` y `1.9.3`, pero Jessie sólo dispone de la versión `2.1.5` (incompatible) y `1.5.6` (no probada), por lo tanto se recomienda instalar la versión `1.9.3` utilizando un método por fuera del sistema de paquetes Debian, como RVM (Ruby Version Manager).

---------

#### Compilación de la librería ['jbig2enc'](https://github.com/agl/jbig2enc)

[JBIG2](http://en.wikipedia.org/wiki/JBIG2) es un algoritmo estandarizado de compresión que genera imágenes de menor tamaño. `jbig2enc` es una implementación libre en python.

El proceso de compilación utiliza el set de herramientas de "GNU build system", que deben estar instaladas en el sistema:

     apt-get install autotools-dev automake libtool

`jbig2enc` utiliza la librería [Leptonica](http://leptonica.com/), que puede instalarse desde el repositorio de Debian:

     apt-get install libleptonica-dev

Otras dependencias de desarrollo necesarias `libjpeg`, `libtiff`, `libpng`, y `zlib1g`:

    apt-get install libjpeg8-dev libtiff5-dev libpng12-dev zlib1g-dev

Obtener el código fuente de `jbig2enc` desde el GitHub [descargando el ZIP](https://github.com/agl/jbig2enc/archive/master.zip) y descomprimiendo el archivo en la carpeta elegida para realizar la compilación (recomendado), o clonando el repositorio con el comando `git clone https://github.com/agl/jbig2enc.git`.

Luego, ingresar al directorio que contiene el código fuente:

    cd jbig2enc-master

Seguir el proceso tradicional de compilación:

    ./autogen.sh
    ./configure
    make

Y para instalar en el sistema utilizar (como root):

    make install

O `chekinstall` (recomendado, genera un paquete `.deb` que luego se puede instalar/desinstalar fácilmente sin tener que compilar de nuevo)

Si `make` responde que no existen reglas para construir "checkinstall" significa que `chekinstall` no está instalado, entonces (como *root*): `apt-get install checkinstall`

En caso de usar `checkinstall` asegurarse que exista el directorio `/usr/local/share/doc` en el sistema. Puede creárselo con el comando (como root) `mkdir /usr/local/share/doc`. Además debe ingresarse un número de versión correcto (puede obtenerse [desde este archivo](https://github.com/agl/jbig2enc/blob/master/ChangeLog)) en el ítem 3 de la lista devuelta por `checkinstall` antes de iniciar el proceso de construcción del paquete deb (por defecto `checkinstall` colocará "master" y provocará un error).

##### Instalación de Ruby 1.9.1 en Debian Wheezy

Instalar [RubyGems](http://rubygems.org/), el gestor de paquetes para el lenguaje de programación [Ruby](http://es.wikipedia.org/wiki/Ruby):

    apt-get install ruby-full ruby-dev rubygems

nota: en mayo de 2014 `apt-get install ruby1.9.1-full ruby1.9.1-dev rubygems1.9.1`

Instalar los siguientes paquetes de Ruby que pueden instalarse desde el gestor de paquetes Debian:

    apt-get install ruby-rmagick ruby-hpricot


##### instalación de Ruby 1.9.3 en Debian Jessie

En caso de haber instalado una versión de `ruby` con el sistema de paquetes de Debian, se recomieda desintalarlo:

     apt-get autoremove ruby ruby-rmagick ruby-hpricot rubygems

luego como *root*

    gpg --keyserver hkp://keys.gnupg.net --recv-keys 409B6B1796C275462A1703113804BB82D39DC0E3
    curl -sSL https://get.rvm.io | bash -s stable
    usermod -a -G rvm <usuario>

donde <usuario> es el usuario (o los usuarios) sin privilegios que utilizarán `pdfbeads`.

Como el entorno de RVM se carga desde `/etc/profile.d/rvm.sh`, hay que loguearse nuevamente para que se cargue (por lo tanto para loguearse como *root* no basta con `su -`, se debe utilizar una consola desde `Ctrl + Alt + Fx` (en una máquina virtual esto se consigue con HOST + Fx, donde HOST generalmente la tecla Ctrl derecha). Para volver a la intefase visual: `Ctrl + Alt + f7`

logueado como *root* instalar ruby

     rvm install 1.9.3

y luego 

     rvm use 1.9.3

Luego, `pdfbeads` no necesita ejecutarse con privilegios,

Para comprobar el buen funcionamiento de `pdfbeads` ejecutar -> `pdfbeads -h`


##### instalación de PDFbeads

Simplemente ejecutar (como root)

     gem install pdfbeads

en caso de problemas con imagemagick ("No package 'MagickCore' found"):

     apt-get install libmagickwand-dev imagemagick

